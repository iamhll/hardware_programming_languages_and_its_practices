.. -----------------------------------------------------------------------------
   ..
   ..  Filename       : index.rst
   ..  Author         : Huang Leilei
   ..  Status         : draft
   ..  Created        : 2025-02-18
   ..  Description    : version control
   ..
.. -----------------------------------------------------------------------------

Version Control
===============

Platform
--------

   |   Code Aliyun (https://code.aliyun.com/) is chosen as the platform for our version control.
   |   Please sign up and send your username to me.


Policy
------

   |   **Always exchange files through Git.**
   |   **Always revert unnecessary changes and make each commit "atomic"**
   |   **Always use "rebase" rather than "merge".**


Deployment
----------

   .. image:: deployment.png
      :width: 1000


Flow
----

for junior developers
`````````````````````

   .. table::
      :align: left
      :widths: auto

      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | operation                 | graph                 | operation       | command                                       |
      | of master                 |                       | of developer    | of developer                                  |
      +===========================+=======================+=================+===============================================+
      | create a repo             | .. image:: flow00.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | edit and commit           | .. image:: flow01.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | push                      | .. image:: flow02.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      |                           | .. image:: flow03.png | clone           | git clone git@code.aliyun.com:llhuang/???.git |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | create a new branch,    | .. image:: flow04.png |                 |                                               |
      | | for example, test       |    :width: 320        |                 |                                               |
      | | switch to test          |                       |                 |                                               |
      | | edit and commit         |                       |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | push                      | .. image:: flow05.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      |                           | .. image:: flow06.png | pull            | git checkout -b test_id origin/test           |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | switch to master        | .. image:: flow07.png | edit and commit | | *edit*                                      |
      | | edit and commit         |    :width: 320        |                 | | git add                                     |
      |                           |                       |                 | | git commit                                  |
      |                           |                       |                 | | ...                                         |
      |                           |                       |                 | | *edit*                                      |
      |                           |                       |                 | | git add                                     |
      |                           |                       |                 | | git commit                                  |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      |                           | .. image:: flow08.png | push            | git push origin test_id                       |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | switch to test          | .. image:: flow09.png |                 |                                               |
      | | pull and rebase         |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | edit and commit           | .. image:: flow10.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | push                      | .. image:: flow11.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      |                           | .. image:: flow12.png | pull            | git reset --hard origin/test                  |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | switch to master        | .. image:: flow13.png | edit and commit | | *edit*                                      |
      | | edit and commit         |    :width: 320        |                 | | git add                                     |
      |                           |                       |                 | | git commit                                  |
      |                           |                       |                 | | ...                                         |
      |                           |                       |                 | | *edit*                                      |
      |                           |                       |                 | | git add                                     |
      |                           |                       |                 | | git commit                                  |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      |                           | .. image:: flow14.png | push            | git push -f origin test_id                    |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | switch to test          | .. image:: flow15.png |                 |                                               |
      | | pull and rebase         |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | edit and commit         | .. image:: flow16.png |                 |                                               |
      | | "make a shortcut"       |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | | switch to master        | .. image:: flow17.png |                 |                                               |
      | | rebase                  |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      | push                      | .. image:: flow18.png |                 |                                               |
      |                           |    :width: 320        |                 |                                               |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+
      |                           | .. image:: flow19.png | pull            | | git checkout master                         |
      |                           |    :width: 320        |                 | | git pull (--rebase)                         |
      |                           |                       |                 | | git branch -D test_id                       |
      +---------------------------+-----------------------+-----------------+-----------------------------------------------+

for senior developers
`````````````````````

   .. table::
      :align: left
      :widths: auto

      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | operation                 | graph                       | operation              | command                                       |
      | of master                 |                             | of developer           | of developer                                  |
      +===========================+=============================+========================+===============================================+
      | create a repo             | .. image:: flowSenior00.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | edit and commit           | .. image:: flowSenior01.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | push                      | .. image:: flowSenior02.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      |                           | .. image:: flowSenior03.png | clone                  | git clone git@code.aliyun.com:llhuang/xxx.git |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | edit and commit           | .. image:: flowSenior04.png | | create a new branch, | | git checkout -b test                        |
      |                           |    :width: 320              | | for example, test    | | *edit*                                      |
      |                           |                             | | switch to test       | | git add                                     |
      |                           |                             | | edit and commit      | | git commit                                  |
      |                           |                             |                        | | *edit*                                      |
      |                           |                             |                        | | git add                                     |
      |                           |                             |                        | | git commit                                  |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      |                           | .. image:: flowSenior05.png | push                   | git push origin test                          |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | pull                      | .. image:: flowSenior06.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | | switch to test          | .. image:: flowSenior07.png | edit and commit        | | *edit*                                      |
      | | edit and commit         |    :width: 320              |                        | | git add                                     |
      |                           |                             |                        | | git commit                                  |
      |                           |                             |                        | | ...                                         |
      |                           |                             |                        | | *edit*                                      |
      |                           |                             |                        | | git add                                     |
      |                           |                             |                        | | git commit                                  |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | push                      | .. image:: flowSenior08.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      |                           | .. image:: flowSenior09.png |                        | | git pull --rebase origin test               |
      |                           |    :width: 320              |                        | | (\ *fix conflicts*)                         |
      |                           |                             |                        | | (git rebase \-\-continue)                   |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | | switch to master        | .. image:: flowSenior10.png | edit and commit        | | *edit*                                      |
      | | edit and commit         |    :width: 320              |                        | | git add                                     |
      |                           |                             |                        | | git commit                                  |
      |                           |                             |                        | | ...                                         |
      |                           |                             |                        | | *edit*                                      |
      |                           |                             |                        | | git add                                     |
      |                           |                             |                        | | git commit                                  |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      |                           | .. image:: flowSenior11.png | push                   | git push origin test                          |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | pull                      | .. image:: flowSenior12.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | | switch to test          | .. image:: flowSenior13.png | edit and commit        |                                               |
      | | edit and commit         |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | | switch to master        | .. image:: flowSenior14.png |                        |                                               |
      | | rebase                  |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      | push                      | .. image:: flowSenior15.png |                        |                                               |
      |                           |    :width: 320              |                        |                                               |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
      |                           | .. image:: flowSenior16.png | pull                   | | git pull (--rebase) origin test             |
      |                           |    :width: 320              |                        | | git checkout master                         |
      |                           |                             |                        | | git pull (--rebase)                         |
      +---------------------------+-----------------------------+------------------------+-----------------------------------------------+
